YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~XO_org_price + XI_org_price + XO_org_deal + YO_org_deal)
}
XO_cross_PED <- crossPEDLMXO(data.ref)
summary(XO_cross_PED)
crossPEDLMXO <- function(data.ref, BRAND="X", CLASS="organic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~XO_org_price + XO_org_deal + YO_org_deal)
}
XO_cross_PED <- crossPEDLMXO(data.ref)
summary(XO_cross_PED)
crossPEDLMYO <- function(data.ref, BRAND="Y", CLASS="organic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~hVal + XO_org_price + YO_org_price + XI_org_price + YI_org_price + XO_org_deal + YO_org_deal + XI_org_deal + YI_org_deal)
}
YO_cross_PED <- crossPEDLMYO(data.ref, "Y", "organic")
summary(YO_cross_PED)
crossPEDLMYO <- function(data.ref, BRAND="Y", CLASS="organic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~hVal + XO_org_price + YO_org_price + XI_org_price + YI_org_price + XO_org_deal + YO_org_deal + XI_org_deal)
}
YO_cross_PED <- crossPEDLMYO(data.ref, "Y", "organic")
summary(YO_cross_PED)
crossPEDLMYO <- function(data.ref, BRAND="Y", CLASS="organic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~hVal + XO_org_price + YO_org_price + XI_org_price + XO_org_deal + YO_org_deal + XI_org_deal)
}
YO_cross_PED <- crossPEDLMYO(data.ref, "Y", "organic")
summary(YO_cross_PED)
crossPEDLMYO <- function(data.ref, BRAND="Y", CLASS="organic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~hVal + XO_org_price + YO_org_price + XI_org_price + YO_org_deal + XI_org_deal)
}
YO_cross_PED <- crossPEDLMYO(data.ref, "Y", "organic")
summary(YO_cross_PED)
crossPEDLMYO <- function(data.ref, BRAND="Y", CLASS="organic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~XO_org_price + YO_org_price + XI_org_price + YO_org_deal + XI_org_deal)
}
YO_cross_PED <- crossPEDLMYO(data.ref, "Y", "organic")
summary(YO_cross_PED)
crossPEDLMYO <- function(data.ref, BRAND="Y", CLASS="organic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~XO_org_price + YO_org_price + XI_org_price + XO_org_deal + YO_org_deal + XI_org_deal)
}
YO_cross_PED <- crossPEDLMYO(data.ref, "Y", "organic")
summary(YO_cross_PED)
crossPEDLMYO <- function(data.ref, BRAND="Y", CLASS="organic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~XO_org_price + YO_org_price + XI_org_price + YO_org_deal + XI_org_deal)
}
XO_cross_PED <- crossPEDLMXO(data.ref, "X", "organic")
summary(XO_cross_PED)
YO_cross_PED <- crossPEDLMYO(data.ref, "Y", "organic")
summary(YO_cross_PED)
crossPEDLMYO <- function(data.ref, BRAND="Y", CLASS="organic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~XO_org_price + YO_org_price + YO_org_deal + XI_org_deal)
}
YO_cross_PED <- crossPEDLMYO(data.ref, "Y", "organic")
summary(YO_cross_PED)
crossPEDLMYO <- function(data.ref, BRAND="Y", CLASS="organic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~XO_org_price + YO_org_price + YO_org_deal)
}
YO_cross_PED <- crossPEDLMYO(data.ref, "Y", "organic")
summary(YO_cross_PED)
XI_cross_PED <- crossPEDLM(data.ref, "X", "nonorganic")
summary(XI_cross_PED)
crossPEDLMXI <- function(data.ref, BRAND="X", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~hVal + YO_org_price + XI_org_price + YI_org_price + XO_org_deal + YO_org_deal + XI_org_deal + YI_org_deal)
}
XI_cross_PED <- crossPEDLMXI(data.ref, "X", "nonorganic")
summary(XI_cross_PED)
crossPEDLMXI <- function(data.ref, BRAND="X", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~YO_org_price + XI_org_price + YI_org_price + XO_org_deal + YO_org_deal + XI_org_deal + YI_org_deal)
}
XI_cross_PED <- crossPEDLMXI(data.ref, "X", "nonorganic")
summary(XI_cross_PED)
crossPEDLMXI <- function(data.ref, BRAND="X", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~YO_org_price + XI_org_price + YI_org_price + XO_org_deal + YO_org_deal + XI_org_deal)
}
XI_cross_PED <- crossPEDLMXI(data.ref, "X", "nonorganic")
summary(XI_cross_PED)
crossPEDLMXI <- function(data.ref, BRAND="X", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~YO_org_price + XI_org_price + YI_org_price + YO_org_deal + XI_org_deal)
}
XI_cross_PED <- crossPEDLMXI(data.ref, "X", "nonorganic")
summary(XI_cross_PED)
crossPEDLMXI <- function(data.ref, BRAND="X", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~XI_org_price + YI_org_price + YO_org_deal + XI_org_deal)
}
XI_cross_PED <- crossPEDLMXI(data.ref, "X", "nonorganic")
summary(XI_cross_PED)
crossPEDLMXI <- function(data.ref, BRAND="X", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~XI_org_price + YI_org_price + XI_org_deal)
}
XI_cross_PED <- crossPEDLMXI(data.ref, "X", "nonorganic")
summary(XI_cross_PED)
crossPEDLMYI <- function(data.ref, BRAND="Y", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~hVal + XO_org_price + YO_org_price + XI_org_price + YI_org_price + XO_org_deal + YO_org_deal + XI_org_deal + YI_org_deal)
}
YI_cross_PED <- crossPEDLMYI(data.ref, "Y", "nonorganic")
summary(YI_cross_PED)
crossPEDLMYI <- function(data.ref, BRAND="Y", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~hVal + XO_org_price + YO_org_price + XI_org_price + YI_org_price + XO_org_deal + XI_org_deal + YI_org_deal)
}
YI_cross_PED <- crossPEDLMYI(data.ref, "Y", "nonorganic")
summary(YI_cross_PED)
crossPEDLMYI <- function(data.ref, BRAND="Y", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~hVal + XO_org_price + YO_org_price + XI_org_price + YI_org_price + XI_org_deal + YI_org_deal)
}
YI_cross_PED <- crossPEDLMYI(data.ref, "Y", "nonorganic")
summary(YI_cross_PED)
crossPEDLMYI <- function(data.ref, BRAND="Y", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~hVal + XO_org_price + XI_org_price + YI_org_price + XI_org_deal + YI_org_deal)
}
YI_cross_PED <- crossPEDLMYI(data.ref, "Y", "nonorganic")
summary(YI_cross_PED)
crossPEDLMYI <- function(data.ref, BRAND="Y", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~hVal + XO_org_price + XI_org_price + YI_org_price + YI_org_deal)
}
YI_cross_PED <- crossPEDLMYI(data.ref, "Y", "nonorganic")
summary(YI_cross_PED)
crossPEDLMYI <- function(data.ref, BRAND="Y", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~hVal + XI_org_price + YI_org_price + YI_org_deal)
}
YI_cross_PED <- crossPEDLMYI(data.ref, "Y", "nonorganic")
summary(YI_cross_PED)
crossPEDLMYI <- function(data.ref, BRAND="Y", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~XI_org_price + YI_org_price + YI_org_deal)
}
YI_cross_PED <- crossPEDLMYI(data.ref, "Y", "nonorganic")
summary(YI_cross_PED)
crossPEDLMYI <- function(data.ref, BRAND="Y", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~YI_org_price + YI_org_deal)
}
YI_cross_PED <- crossPEDLMYI(data.ref, "Y", "nonorganic")
summary(YI_cross_PED)
crossPEDLMYI <- function(data.ref, BRAND="Y", CLASS="nonorganic") {
quantity <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(oz) %>% log() %>% as.matrix()
hVal <- data.ref %>% filter(brand==BRAND, class==CLASS) %>% select(Hval) %>% log() %>% as.matrix()
XO_org_price <- data.ref %>% filter(brand=="X", class=="organic") %>% select(p) %>% log() %>% as.matrix()
YO_org_price <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(p) %>% log() %>% as.matrix()
XI_org_price <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
YI_org_price <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(p) %>% log() %>% as.matrix()
XO_org_deal <- data.ref %>% filter(brand=="X", class=="organic") %>% select(deal) %>% as.matrix()
YO_org_deal <- data.ref %>% filter(brand=="Y", class=="organic") %>% select(deal) %>% as.matrix()
XI_org_deal <- data.ref %>% filter(brand=="X", class=="nonorganic") %>% select(deal) %>% as.matrix()
YI_org_deal <- data.ref %>% filter(brand=="Y", class=="nonorganic") %>% select(deal) %>% as.matrix()
lm.crossPED <- lm(quantity~XI_org_price + YI_org_price + YI_org_deal)
}
YI_cross_PED <- crossPEDLMYI(data.ref, "Y", "nonorganic")
summary(YI_cross_PED)
summary_XO_nodeal <- %>% data.ref %>% filter(brand=="X", class=="organic", deal==0) %>% select(oz, p, c)
summary_XO_nodeal <- data.ref %>% filter(brand=="X", class=="organic", deal==0) %>% select(oz, p, c)
View(summary_XO_nodeal)
View(summary_XO_nodeal)
summary_XO_nodeal <- data.ref %>% filter(brand=="X", class=="organic", deal==1) %>% select(oz, p, c)
rbind(summary_XO_nodeal,summary_XO_deal)
summary_XO_nodeal <- data.ref %>% filter(brand=="X", class=="organic", deal==0) %>% select(oz, p, c)
summary_XO_deal <- data.ref %>% filter(brand=="X", class=="organic", deal==1) %>% select(oz, p, c)
rbind(summary_XO_nodeal,summary_XO_deal)
summary_XO <- mutate(summary_XO, profit=oz*(p-c))
summary_XO <- data.ref %>% filter(brand=="X", class=="organic") %>% select(oz, p, c)
summary_XO <- mutate(summary_XO, profit=oz*(p-c))
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot() + labs(title="Boxplots of profit for different products", x="Product", y = "Profit")
summary_XO <- data.ref %>% filter(brand=="X", class=="organic") %>% select(oz, p, c, deal)
summary_XO <- mutate(summary_XO, profit=oz*(p-c))
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot() + labs(title="Boxplots of profit for different products", x="Product", y = "Profit")
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot(aes(group = cut_width(STORE, 1))) + labs(title="Boxplots of profit for different products", x="Product", y = "Profit")
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot(aes(group = cut_width(deal, 1))) + labs(title="Boxplots of profit for different products", x="Product", y = "Profit")
limits=c("Without", "With"))
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot(aes(group = cut_width(deal, 1))) + labs(title="XO profit with and without a deal", x="Deal", y = "Profit") + scale_x_discrete(name ="Deal",                limits=c("Without", "With"))
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot(aes(group = cut_width(deal, 0.5))) + labs(title="XO profit with and without a deal", x="Deal", y = "Profit") + scale_x_discrete(name ="Deal",                limits=c("With", "Without"))
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot() + labs(title="XO profit with and without a deal", x="Deal", y = "Profit") + scale_x_discrete(name ="Deal", limits=c("With", "Without"))
summary_XO <- data.ref %>% filter(brand=="X", class=="organic") %>% select(oz, p, c, deal)
summary_XO <- mutate(summary_XO, profit=oz*(p-c))
summary_XO$deal[summary_XO$deal == 0] <- "Without"
summary_XO$deal[summary_XO$deal == 1] <- "With"
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot() + labs(title="XO profit with and without a deal", x="Deal", y = "Profit")
ggplot(summary_XO, aes(x=deal, y=oz)) + geom_boxplot() + labs(title="XO profit with and without a deal", x="Deal", y = "Profit")
summary_XO <- data.ref %>% filter(brand=="X", class=="organic") %>% select(oz, p, c, deal, feat)
summary_XO <- mutate(summary_XO, profit=oz*(p-c))
summary_XO$deal[summary_XO$deal == 0] <- "Without"
summary_XO$deal[summary_XO$deal == 1] <- "With"
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot() + labs(title="XO profit with and without a deal", x="Deal", y = "Profit")
ggplot(summary_XO, aes(x=deal, y=oz)) + geom_boxplot() + labs(title="XO oz sold with and without a deal", x="Deal", y = "Oz")
ggplot(summary_XO, aes(x=feat, y=profit)) + geom_boxplot() + labs(title="XO profit with and without a deal", x="Deal", y = "Profit")
ggplot(summary_XO, aes(x=fat, y=oz)) + geom_boxplot() + labs(title="XO oz sold with and without a deal", x="Deal", y = "Oz")
# Organic X
dataR <- data %>% filter(class=="organic") %>% select(STORE, WEEK, Hval_150, pX, cX, oz_X, deal_X, feat_X)
dataR$brand <- "X"
dataR$class <- "organic"
colnames(dataR) <- c("STORE", "WEEK", "Hval", "p", "c", "oz", "deal", "feat", "brand", "class")
data.ref <- dataR
# Organic Y
dataR <- data %>% filter(class=="organic") %>% select(STORE, WEEK, Hval_150, pY, cY, oz_Y, deal_Y, feat_Y)
dataR$brand <- "Y"
dataR$class <- "organic"
colnames(dataR) <- c("STORE", "WEEK", "Hval", "p", "c", "oz", "deal", "feat", "brand", "class")
data.ref <- rbind(data.ref, dataR)
# NonOrganic X
dataR <- data %>% filter(class=="nonorganic") %>% select(STORE, WEEK, Hval_150, pX, cX, oz_X, deal_X, feat_X)
dataR$brand <- "X"
dataR$class <- "nonorganic"
colnames(dataR) <- c("STORE", "WEEK", "Hval", "p", "c", "oz", "deal", "feat", "brand", "class")
data.ref <- rbind(data.ref, dataR)
# NonOrganic Y
dataR <- data %>% filter(class=="nonorganic") %>% select(STORE, WEEK, Hval_150, pY, cY, oz_Y, deal_Y, feat_Y)
dataR$brand <- "Y"
dataR$class <- "nonorganic"
colnames(dataR) <- c("STORE", "WEEK", "Hval", "p", "c", "oz", "deal", "feat", "brand", "class")
data.ref <- rbind(data.ref, dataR)
summary_XO <- data.ref %>% filter(brand=="X", class=="organic") %>% select(oz, p, c, deal, feat)
summary_XO <- mutate(summary_XO, profit=oz*(p-c))
summary_XO$deal[summary_XO$deal == 0] <- "Without"
summary_XO$deal[summary_XO$deal == 1] <- "With"
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot() + labs(title="XO profit with and without a deal", x="Deal", y = "Profit")
ggplot(summary_XO, aes(x=deal, y=oz)) + geom_boxplot() + labs(title="XO oz sold with and without a deal", x="Deal", y = "Oz")
ggplot(summary_XO, aes(x=feat, y=profit)) + geom_boxplot() + labs(title="XO profit with and without a deal", x="Deal", y = "Profit")
summary_XO$deal[summary_XO$feat == 0] <- "Without"
summary_XO$deal[summary_XO$feat == 1] <- "With"
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot() + labs(title="XO profit with and without a deal", x="Deal", y = "Profit")
ggplot(summary_XO, aes(x=deal, y=oz)) + geom_boxplot() + labs(title="XO oz sold with and without a deal", x="Deal", y = "Oz")
ggplot(summary_XO, aes(x=feat, y=profit)) + geom_boxplot() + labs(title="XO profit with and without a deal", x="Deal", y = "Profit")
ggplot(summary_XO, aes(x=feat, y=oz)) + geom_boxplot() + labs(title="XO oz sold with and without a deal", x="Deal", y = "Oz")
summary_XO <- data.ref %>% filter(brand=="X", class=="organic") %>% select(oz, p, c, deal, feat)
summary_XO <- mutate(summary_XO, profit=oz*(p-c))
summary_XO$deal[summary_XO$deal == 0] <- "Without"
summary_XO$deal[summary_XO$deal == 1] <- "With"
summary_XO$feat[summary_XO$feat == 0] <- "Without"
summary_XO$feat[summary_XO$feat == 1] <- "With"
ggplot(summary_XO, aes(x=deal, y=profit)) + geom_boxplot() + labs(title="XO profit with and without a deal", x="Deal", y = "Profit")
ggplot(summary_XO, aes(x=deal, y=oz)) + geom_boxplot() + labs(title="XO oz sold with and without a deal", x="Deal", y = "Oz")
ggplot(summary_XO, aes(x=feat, y=profit)) + geom_boxplot() + labs(title="XO profit with and without a deal", x="Deal", y = "Profit")
ggplot(summary_XO, aes(x=feat, y=oz)) + geom_boxplot() + labs(title="XO oz sold with and without a deal", x="Deal", y = "Oz")
generalScatterResults <- data.ref %>% select(WEEK, p, c, oz, class, brand)
generalScatterResults <- mutate(profit=oz*(p-c))
generalScatterResults <- generalScatterResults %>% mutate(profit=oz*(p-c))
generalScatterResults <- generalScatterResults %>% mutate(type=paste(brand,class,sep="_"))
geom_point(aes(y=profit_Y_org, colour=type))
ggplot(generalScatterResults, aes(x=WEEK)) +
geom_point(aes(y=profit_Y_org, colour=type))
geom_point(aes(y=profit, colour=type))
ggplot(generalScatterResults, aes(x=WEEK)) +
geom_point(aes(y=profit, colour=type))
generalScatterResults <- data.ref %>% select(WEEK, p, c, oz, deal, class, brand)
generalScatterResults <- generalScatterResults %>% mutate(profit=oz*(p-c))
generalScatterResults <- generalScatterResults %>% mutate(type=paste(brand,class,deal,sep="_"))
ggplot(generalScatterResults, aes(x=WEEK)) +
geom_point(aes(y=profit, colour=type))
generalScatterResults <- data.ref %>% select(WEEK, p, c, oz, deal, class, brand)
generalScatterResults$deal[generalScatterResults$deal == 1] = "w deal"
generalScatterResults$deal[generalScatterResults$deal == 0] = "w/o deal"
generalScatterResults <- generalScatterResults %>% mutate(profit=oz*(p-c))
generalScatterResults <- generalScatterResults %>% mutate(type=paste(brand,class,deal,sep=" "))
ggplot(generalScatterResults, aes(x=WEEK)) +
geom_point(aes(y=profit, colour=type))
ggplot(generalScatterResults, aes(x=WEEK)) +
geom_point(aes(y=profit, colour=type)) +
scale_colour_manual(values=cbbPalette) +
labs(x = "Week", y = "Profit", title = paste("Profit for Store",store_ID))
generalScatterResults <- data.ref %>% select(WEEK, p, c, oz, deal, class, brand)
generalScatterResults$deal[generalScatterResults$deal == 1] = "w deal"
generalScatterResults$deal[generalScatterResults$deal == 0] = "w/o deal"
generalScatterResults <- generalScatterResults %>% mutate(profit=oz*(p-c))
generalScatterResults <- generalScatterResults %>% mutate(type=paste(brand,class,deal,sep=" "))
ggplot(generalScatterResults, aes(x=WEEK)) +
geom_point(aes(y=profit, colour=type)) +
scale_colour_manual(values=cbbPalette) +
labs(x = "Week", y = "Profit", title = "Profit for products across all stores")
cbbPalette <- c("red4", "orange1", "blue4", "skyblue1", "green4", "chartreuse1", "darkorchid4", "mediumorchid1")
generalScatterResults <- data.ref %>% select(WEEK, p, c, oz, deal, class, brand)
generalScatterResults$deal[generalScatterResults$deal == 1] = "w deal"
generalScatterResults$deal[generalScatterResults$deal == 0] = "w/o deal"
generalScatterResults <- generalScatterResults %>% mutate(profit=oz*(p-c))
generalScatterResults <- generalScatterResults %>% mutate(type=paste(brand,class,deal,sep=" "))
ggplot(generalScatterResults, aes(x=WEEK)) +
geom_point(aes(y=profit, colour=type)) +
scale_colour_manual(values=cbbPalette) +
labs(x = "Week", y = "Profit", title = "Profit for products across all stores")
